<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.prime.com.tr/ui"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jstl/core"
	template="/templates/base.xhtml">

	<ui:define name="title">Configuration de la Drivebox</ui:define>
	<ui:define name="menu"></ui:define>
	<ui:define name="title_page">Configuration de la Drivebox</ui:define>
	<ui:define name="content">
		<h:form id="paramForm">
			<p:growl id="growl" showDetail="false" />
			<table>
				<tr>
					<th>Nom</th>
					<td><h:inputText
							binding="#{configDriveboxController.nameInput}" /></td>
				</tr>
				<tr>
					<th>Numéro de transfert</th>
					<td><h:inputText
							binding="#{configDriveboxController.numInput}" /></td>
				</tr>
				<tr>
					<th>Muet</th>
					<td><h:selectBooleanCheckbox
							binding="#{configDriveboxController.muteInput}" />
					</td>
				</tr>
				<tr>
					<td><p:commandButton value="Sauver" title="Sauver"
							actionListener="#{configDriveboxController.saveParams}"
							ajax="true" id="updateButton" update="growl" />
					</td>
				</tr>
			</table>

			<br />
			<br />

			<p:commandButton
				actionListener="#{configDriveboxController.updateDrivebox}"
				ajax="true" value="Mise à jour" update="growl" />
		</h:form>
		<h:form prependId="false" id="dashboardForm">
			<p:messages id="msgs" showDetail="false" />
			<h:panelGrid columns="5" cellspacing="0" cellpadding="0"
				id="installedAppsGrid">
				<!-- <ui:repeat value="#{configDriveboxController.tab}" var="row" >
						<ui:repeat value="#{row}" var="cell"> -->
				<p:outputPanel
					style="background: #333333; width: 80px; height: 80px; display: block; border: 1px solid #222222; text-align:center;">
					<p:droppable dropListener="#{configDriveboxController.onDrop}"
						tolerance="fit" activeStyleClass="slotActive" scope="test"
						id="appDrop_0_0" onDropUpdate="installedAppsGrid msgs"
						datasource="availableApps" />
					<p:graphicImage
						value="#{configDriveboxController.installedAppIcon(0,0)}"
						rendered="#{configDriveboxController.iconHasToBeDisplayed(0,0)}"
						styleClass="appImage"
						title="#{configDriveboxController.installedAppName(0,0)}"
						style="opacity: 0.2; filter:alpha(opacity=20);" />
				</p:outputPanel>

				<!-- 	</ui:repeat>
					</ui:repeat>-->

				<p:outputPanel
					style="background: #333333; width: 80px; height: 80px; display: block; border: 1px solid #222222; text-align:center;">
					<p:droppable dropListener="#{configDriveboxController.onDrop}"
						tolerance="fit" activeStyleClass="slotActive" scope="test"
						id="appDrop_0_1" onDropUpdate="installedAppsGrid msgs"
						datasource="availableApps" />
					<p:graphicImage
						value="#{configDriveboxController.installedAppIcon(0,1)}"
						rendered="#{configDriveboxController.iconHasToBeDisplayed(0,1)}"
						styleClass="appImage"
						title="#{configDriveboxController.installedAppName(0,1)}"
						style="opacity: 0.2; filter:alpha(opacity=20);" />
				</p:outputPanel>
				<p:outputPanel
					style="background: #333333; width: 80px; height: 80px; display: block; border: 1px solid #222222; text-align:center;">
					<p:droppable dropListener="#{configDriveboxController.onDrop}"
						tolerance="fit" activeStyleClass="slotActive" scope="test"
						id="appDrop_0_2" onDropUpdate="installedAppsGrid msgs"
						datasource="availableApps" />
					<p:graphicImage
						value="#{configDriveboxController.installedAppIcon(0,2)}"
						rendered="#{configDriveboxController.iconHasToBeDisplayed(0,2)}"
						styleClass="appImage"
						title="#{configDriveboxController.installedAppName(0,2)}"
						style="opacity: 0.2; filter:alpha(opacity=20);" />
				</p:outputPanel>
				<p:outputPanel
					style="background: #333333; width: 80px; height: 80px; display: block; border: 1px solid #222222; text-align:center;">
					<p:droppable dropListener="#{configDriveboxController.onDrop}"
						tolerance="fit" activeStyleClass="slotActive" scope="test"
						id="appDrop_0_3" onDropUpdate="installedAppsGrid msgs"
						datasource="availableApps" />
					<p:graphicImage
						value="#{configDriveboxController.installedAppIcon(0,3)}"
						rendered="#{configDriveboxController.iconHasToBeDisplayed(0,3)}"
						styleClass="appImage"
						title="#{configDriveboxController.installedAppName(0,3)}"
						style="opacity: 0.2; filter:alpha(opacity=20);" />
				</p:outputPanel>
				<p:outputPanel
					style="background: #333333; width: 80px; height: 80px; display: block; border: 1px solid #222222; text-align:center;">
					<p:droppable dropListener="#{configDriveboxController.onDrop}"
						tolerance="fit" activeStyleClass="slotActive" scope="test"
						id="appDrop_0_4" onDropUpdate="installedAppsGrid msgs"
						datasource="availableApps" />
					<p:graphicImage
						value="#{configDriveboxController.installedAppIcon(0,4)}"
						rendered="#{configDriveboxController.iconHasToBeDisplayed(0,4)}"
						styleClass="appImage"
						title="#{configDriveboxController.installedAppName(0,4)}"
						style="opacity: 0.2; filter:alpha(opacity=20);" />
				</p:outputPanel>
				<p:outputPanel
					style="background: #333333; width: 80px; height: 80px; display: block; border: 1px solid #222222; text-align:center;">
					<p:droppable dropListener="#{configDriveboxController.onDrop}"
						tolerance="fit" activeStyleClass="slotActive" scope="test"
						id="appDrop_1_0" onDropUpdate="installedAppsGrid msgs"
						datasource="availableApps" />
					<p:graphicImage
						value="#{configDriveboxController.installedAppIcon(1,0)}"
						rendered="#{configDriveboxController.iconHasToBeDisplayed(1,0)}"
						styleClass="appImage"
						title="#{configDriveboxController.installedAppName(1,0)}"
						style="opacity: 0.2; filter:alpha(opacity=20);" />
				</p:outputPanel>
				<p:outputPanel
					style="background: #333333; width: 80px; height: 80px; display: block; border: 1px solid #222222; text-align:center;">
					<p:droppable dropListener="#{configDriveboxController.onDrop}"
						tolerance="fit" activeStyleClass="slotActive" scope="test"
						id="appDrop_1_1" onDropUpdate="installedAppsGrid msgs"
						datasource="availableApps" />
					<p:graphicImage
						value="#{configDriveboxController.installedAppIcon(1,1)}"
						rendered="#{configDriveboxController.iconHasToBeDisplayed(1,1)}"
						styleClass="appImage"
						title="#{configDriveboxController.installedAppName(1,1)}"
						style="opacity: 0.2; filter:alpha(opacity=20);" />
				</p:outputPanel>
				<p:outputPanel
					style="background: #333333; width: 80px; height: 80px; display: block; border: 1px solid #222222; text-align:center;">
					<p:droppable dropListener="#{configDriveboxController.onDrop}"
						tolerance="fit" activeStyleClass="slotActive" scope="test"
						id="appDrop_1_2" onDropUpdate="installedAppsGrid msgs"
						datasource="availableApps" />
					<p:graphicImage
						value="#{configDriveboxController.installedAppIcon(1,2)}"
						rendered="#{configDriveboxController.iconHasToBeDisplayed(1,2)}"
						styleClass="appImage"
						title="#{configDriveboxController.installedAppName(1,2)}"
						style="opacity: 0.2; filter:alpha(opacity=20);" />
				</p:outputPanel>
				<p:outputPanel
					style="background: #333333; width: 80px; height: 80px; display: block; border: 1px solid #222222; text-align:center;">
					<p:droppable dropListener="#{configDriveboxController.onDrop}"
						tolerance="fit" activeStyleClass="slotActive" scope="test"
						id="appDrop_1_3" onDropUpdate="installedAppsGrid msgs"
						datasource="availableApps" />
					<p:graphicImage
						value="#{configDriveboxController.installedAppIcon(1,3)}"
						rendered="#{configDriveboxController.iconHasToBeDisplayed(1,3)}"
						styleClass="appImage"
						title="#{configDriveboxController.installedAppName(1,3)}"
						style="opacity: 0.2; filter:alpha(opacity=20);" />
				</p:outputPanel>
				<p:outputPanel
					style="background: #333333; width: 80px; height: 80px; display: block; border: 1px solid #222222; text-align:center;">
					<p:droppable dropListener="#{configDriveboxController.onDrop}"
						tolerance="fit" activeStyleClass="slotActive" scope="test"
						id="appDrop_1_4" onDropUpdate="installedAppsGrid msgs"
						datasource="availableApps" />
					<p:graphicImage
						value="#{configDriveboxController.installedAppIcon(1,4)}"
						rendered="#{configDriveboxController.iconHasToBeDisplayed(1,4)}"
						styleClass="appImage"
						title="#{configDriveboxController.installedAppName(1,4)}"
						style="opacity: 0.2; filter:alpha(opacity=20);" />
				</p:outputPanel>

			</h:panelGrid>
			<br />
			<p:panel header="Applications disponibles">
				<p:dataGrid id="availableApps"
					value="#{configDriveboxController.lApp}" var="app" columns="4">
					<p:column>
						<p:panel header="#{app.name}">

							<p:graphicImage id="application"
								value="#{configDriveboxController.appIconStream}"
								styleClass="appImage">
								<f:param name="pkApp" value="#{app.pkApplication}"></f:param>
							</p:graphicImage>
							<p:draggable for="application" revert="true" stack=".appImage"
								scope="test" />
							<h:commandLink
								action="#{configDriveboxController.updateParam(app.pkApplication)}">configure</h:commandLink>

							<p:droppable
								dropListener="#{configDriveboxController.onDropBack}"
								tolerance="fit" activeStyleClass="slotActive"
								datasource="availableApps" scope="test"
								onDropUpdate="installedAppsGrid msgs" />
						</p:panel>
					</p:column>
				</p:dataGrid>

			</p:panel>
		</h:form>
		<br/>
		<br/>
		<h:form id="sipDeviceForm">
		<p:commandButton
				actionListener="#{configDriveboxController.updateSipDevices}"
				ajax="true" value="Mise à jour" update="sipDeviceForm growl" />
			<p:dataTable var="sipDevice"
				value="#{configDriveboxController.sipDevices}" id="sipDevices"
				emptyMessage="Vous n'avez actuellement aucun périphérique SIP">

				<!-- Device's ID -->
				<p:column filterBy="#{sipDevice.deviceId}" headerText="ID"
					filterMatchMode="contains" filterStyle="width: 5em"
					style="width: 20%">
					<h:outputText value="#{sipDevice.deviceId}" />
				</p:column>
				
				<!-- Device's type -->
				<p:column filterBy="#{sipDevice.deviceType}" headerText="Type"
					filterMatchMode="contains" filterStyle="width: 5em"
					style="width: 20%">
					<h:outputText value="#{sipDevice.deviceType}" />
				</p:column>
				
				<!-- Device's ID -->
				<p:column filterBy="#{sipDevice.deviceStatus}" headerText="Status"
					filterMatchMode="exact" filterStyle="width: 5em"
					style="width: 20%" filterOptions="#{configDriveboxController.deviceStatusOptions}">
					<h:outputText value="#{sipDevice.deviceStatus}" />
				</p:column>
			</p:dataTable>
		</h:form>
	</ui:define>
</ui:composition>
